# Проект: Автоматизация отправки email и Telegram-бот

Данный репозиторий содержит три Python-скрипта, которые работают совместно для автоматизации отправки email с вложениями и управления файлами через Telegram-бота.

## Файлы

### 1. `send.py`
Скрипт для автоматизации процесса отправки email с вложениями. Выполняет следующие задачи:
- Считывает данные учетной записи отправителя из файла `sender.txt`.
- Извлекает email-адреса получателей и их статусы из файла `artists.xlsx`.
- Отправляет письма с вложениями из папки, указанной в `path.txt`, если их размер не превышает 25 МБ.
- Обновляет статус получателей в Excel-файле после отправки.

#### Возможности
- Отправка email новым получателям со статусом `ждет`.
- Отправка email существующим получателям со статусом `отправил биты`.
- Автоматическое прикрепление всех подходящих файлов из папки.

#### Использование
Запустите скрипт с одним из аргументов:
- `python send.py 1`: Отправить email новым получателям со статусом "ждет".
- `python send.py 2`: Отправить email существующим получателям со статусом "отправил биты".

---

### 2. `bot.py`
Скрипт для запуска Telegram-бота, который позволяет управлять файлами и запускать процесс отправки email.

#### Возможности
- **Загрузка файлов**: Пользователи могут загружать файлы (биты) через Telegram-бота.
- **Взаимодействие через кнопки**: Бот предоставляет следующие действия:
  - Загрузить биты.
  - Отправить биты новым или существующим получателям.
  - Очистить папку с битами.
- **Запуск скриптов**: Бот вызывает скрипты `send.py` или `clear.py` в зависимости от выбора пользователя.

#### Использование
1. Укажите токен вашего бота в файле `token.txt`.
2. Запустите бота:
   ```bash
   python bot.py
3. Взаимодействуйте с ботом в Telegram для управления битами, отправки писем или очистки файлов.

---

## Настройка

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/your-repo-name.git
   cd your-repo-name
```markdown
3. Взаимодействуйте с ботом в Telegram для управления битами, отправки писем или очистки файлов.

---

## Настройка

1. **Клонируйте репозиторий**:
   ```bash
   git clone https://github.com/your-repo-name.git
   cd your-repo-name
   ```

2. **Установите зависимости**:
   ```bash
   pip install openpyxl pyTelegramBotAPI
   ```

3. **Подготовьте конфигурационные файлы**:
   - `sender.txt`: Укажите email и пароль отправителя (каждое значение на отдельной строке).
   - `path.txt`: Укажите абсолютный путь к папке, в которой будут храниться файлы с битами.
   - `token.txt`: Укажите токен вашего Telegram-бота.
   - `artists.xlsx`: Excel-файл с данными получателей:
     - Колонка F: email-адреса получателей.
     - Колонка H: статусы получателей (например, `ждет`, `отправил биты`).

4. **Создайте папку для хранения битов**:
   ```
   ```markdown
1. **Запустите Telegram-бота**:
   ```bash
   python bot.py
   ```

2. **Загрузите биты**: Отправьте файлы ботов в Telegram, используя встроенную функцию загрузки.

3. **Отправьте email**:
   - Используйте кнопки бота для выбора получателей:
     - Отправить биты новым артистам (со статусом `ждет`).
     - Отправить биты артистам, которым уже ранее отправлялись файлы (со статусом `отправил биты`).
     - Либо отправить всем артистам, комбинируя действия.
   - Вы также можете запускать отправку вручную:
     ```bash
     python send.py 1  # Для новых артистов
     python send.py 2  # Для артистов, которым уже отправляли
     ```

4. **Очистите папку с битами**:
   - Очистите папку с битами через Telegram-бота, выбрав соответствующую кнопку.
   - Или запустите `clear.py` вручную:
     ```bash
     python clear.py
     ```

---

## Формат данных

### `artists.xlsx`
Excel-файл должен быть структурирован следующим образом:
- **Колонка F**: Email-адреса артистов.
- **Колонка H**: Статус артиста, который может быть:
  - `ждет` — артист ожидает биты.
  - `отправил биты` — биты уже были отправлены артисту.

### `sender.txt`
Текстовый файл с данными учетной записи отправителя:
- Первая строка: email-адрес отправителя.
- Вторая строка: пароль от учетной записи.

### `path.txt`
Текстовый файл, содержащий полный путь к папке, где хранятся файлы с битами. Например:
```
/home/user/beats/
```

### `token.txt`
Файл с токеном вашего Telegram-бота:
```
<ваш_токен>
```

---

## Примечания

- Убедитесь, что учетная запись отправителя поддерживает SMTP и разрешает доступ небезопасным приложениям.
- Не рекомендуется хранить конфиденциальные данные (например, пароль email) в виде открытого текста в продуктивной среде.
- Максимальный размер вложений — 25 МБ на файл.

---

